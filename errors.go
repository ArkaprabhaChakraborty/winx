package winx

import "fmt"

// NTStatusError wraps an NTSTATUS code with additional context.
type NTStatusError struct {
	Status  NTSTATUS
	Message string
}

// Error implements the error interface.
func (e *NTStatusError) Error() string {
	if e.Message != "" {
		return fmt.Sprintf("NTSTATUS 0x%08X: %s", e.Status, e.Message)
	}
	return fmt.Sprintf("NTSTATUS 0x%08X", e.Status)
}

// NewNTStatusError creates a new NTStatusError with the given status code and message.
func NewNTStatusError(status NTSTATUS, message string) error {
	if status == 0 {
		return nil
	}
	return &NTStatusError{
		Status:  status,
		Message: message,
	}
}

// Common NTSTATUS values
const (
	STATUS_SUCCESS                   NTSTATUS = 0x00000000
	STATUS_WAIT_0                    NTSTATUS = 0x00000000
	STATUS_WAIT_1                    NTSTATUS = 0x00000001
	STATUS_WAIT_2                    NTSTATUS = 0x00000002
	STATUS_WAIT_3                    NTSTATUS = 0x00000003
	STATUS_ABANDONED_WAIT_0          NTSTATUS = 0x00000080
	STATUS_ABANDONED_WAIT_63         NTSTATUS = 0x000000BF
	STATUS_USER_APC                  NTSTATUS = 0x000000C0
	STATUS_KERNEL_APC                NTSTATUS = 0x00000100
	STATUS_ALERTED                   NTSTATUS = 0x00000101
	STATUS_TIMEOUT                   NTSTATUS = 0x00000102
	STATUS_PENDING                   NTSTATUS = 0x00000103
	STATUS_REPARSE                   NTSTATUS = 0x00000104
	STATUS_MORE_ENTRIES              NTSTATUS = 0x00000105
	STATUS_NOT_ALL_ASSIGNED          NTSTATUS = 0x00000106
	STATUS_SOME_NOT_MAPPED           NTSTATUS = 0x00000107
	STATUS_OPLOCK_BREAK_IN_PROGRESS  NTSTATUS = 0x00000108
	STATUS_VOLUME_MOUNTED            NTSTATUS = 0x00000109
	STATUS_RXACT_COMMITTED           NTSTATUS = 0x0000010A
	STATUS_NOTIFY_CLEANUP            NTSTATUS = 0x0000010B
	STATUS_NOTIFY_ENUM_DIR           NTSTATUS = 0x0000010C
	STATUS_NO_QUOTAS_FOR_ACCOUNT     NTSTATUS = 0x0000010D
	STATUS_PRIMARY_TRANSPORT_CONNECT_FAILED NTSTATUS = 0x0000010E
	STATUS_PAGE_FAULT_TRANSITION     NTSTATUS = 0x00000110
	STATUS_PAGE_FAULT_DEMAND_ZERO    NTSTATUS = 0x00000111
	STATUS_PAGE_FAULT_COPY_ON_WRITE  NTSTATUS = 0x00000112
	STATUS_PAGE_FAULT_GUARD_PAGE     NTSTATUS = 0x00000113
	STATUS_PAGE_FAULT_PAGING_FILE    NTSTATUS = 0x00000114
	STATUS_CACHE_PAGE_LOCKED         NTSTATUS = 0x00000115
	STATUS_CRASH_DUMP                NTSTATUS = 0x00000116
	STATUS_BUFFER_ALL_ZEROS          NTSTATUS = 0x00000117
	STATUS_REPARSE_OBJECT            NTSTATUS = 0x00000118
	STATUS_RESOURCE_REQUIREMENTS_CHANGED NTSTATUS = 0x00000119
	STATUS_TRANSLATION_COMPLETE      NTSTATUS = 0x00000120
	STATUS_DS_MEMBERSHIP_EVALUATED_LOCALLY NTSTATUS = 0x00000121
	STATUS_NOTHING_TO_TERMINATE      NTSTATUS = 0x00000122
	STATUS_PROCESS_NOT_IN_JOB        NTSTATUS = 0x00000123
	STATUS_PROCESS_IN_JOB            NTSTATUS = 0x00000124
	STATUS_VOLSNAP_HIBERNATE_READY   NTSTATUS = 0x00000125

	// Error codes
	STATUS_UNSUCCESSFUL              NTSTATUS = 0xC0000001
	STATUS_NOT_IMPLEMENTED           NTSTATUS = 0xC0000002
	STATUS_INVALID_INFO_CLASS        NTSTATUS = 0xC0000003
	STATUS_INFO_LENGTH_MISMATCH      NTSTATUS = 0xC0000004
	STATUS_ACCESS_VIOLATION          NTSTATUS = 0xC0000005
	STATUS_IN_PAGE_ERROR             NTSTATUS = 0xC0000006
	STATUS_PAGEFILE_QUOTA            NTSTATUS = 0xC0000007
	STATUS_INVALID_HANDLE            NTSTATUS = 0xC0000008
	STATUS_BAD_INITIAL_STACK         NTSTATUS = 0xC0000009
	STATUS_BAD_INITIAL_PC            NTSTATUS = 0xC000000A
	STATUS_INVALID_CID               NTSTATUS = 0xC000000B
	STATUS_TIMER_NOT_CANCELED        NTSTATUS = 0xC000000C
	STATUS_INVALID_PARAMETER         NTSTATUS = 0xC000000D
	STATUS_NO_SUCH_DEVICE            NTSTATUS = 0xC000000E
	STATUS_NO_SUCH_FILE              NTSTATUS = 0xC000000F
	STATUS_INVALID_DEVICE_REQUEST    NTSTATUS = 0xC0000010
	STATUS_END_OF_FILE               NTSTATUS = 0xC0000011
	STATUS_WRONG_VOLUME              NTSTATUS = 0xC0000012
	STATUS_NO_MEDIA_IN_DEVICE        NTSTATUS = 0xC0000013
	STATUS_UNRECOGNIZED_MEDIA        NTSTATUS = 0xC0000014
	STATUS_NONEXISTENT_SECTOR        NTSTATUS = 0xC0000015
	STATUS_MORE_PROCESSING_REQUIRED  NTSTATUS = 0xC0000016
	STATUS_NO_MEMORY                 NTSTATUS = 0xC0000017
	STATUS_CONFLICTING_ADDRESSES     NTSTATUS = 0xC0000018
	STATUS_NOT_MAPPED_VIEW           NTSTATUS = 0xC0000019
	STATUS_UNABLE_TO_FREE_VM         NTSTATUS = 0xC000001A
	STATUS_UNABLE_TO_DELETE_SECTION  NTSTATUS = 0xC000001B
	STATUS_INVALID_SYSTEM_SERVICE    NTSTATUS = 0xC000001C
	STATUS_ILLEGAL_INSTRUCTION       NTSTATUS = 0xC000001D
	STATUS_INVALID_LOCK_SEQUENCE     NTSTATUS = 0xC000001E
	STATUS_INVALID_VIEW_SIZE         NTSTATUS = 0xC000001F
	STATUS_INVALID_FILE_FOR_SECTION  NTSTATUS = 0xC0000020
	STATUS_ALREADY_COMMITTED         NTSTATUS = 0xC0000021
	STATUS_ACCESS_DENIED             NTSTATUS = 0xC0000022
	STATUS_BUFFER_TOO_SMALL          NTSTATUS = 0xC0000023
	STATUS_OBJECT_TYPE_MISMATCH      NTSTATUS = 0xC0000024
	STATUS_NONCONTINUABLE_EXCEPTION  NTSTATUS = 0xC0000025
	STATUS_INVALID_DISPOSITION       NTSTATUS = 0xC0000026
	STATUS_UNWIND                    NTSTATUS = 0xC0000027
	STATUS_BAD_STACK                 NTSTATUS = 0xC0000028
	STATUS_INVALID_UNWIND_TARGET     NTSTATUS = 0xC0000029
	STATUS_NOT_LOCKED                NTSTATUS = 0xC000002A
	STATUS_PARITY_ERROR              NTSTATUS = 0xC000002B
	STATUS_UNABLE_TO_DECOMMIT_VM     NTSTATUS = 0xC000002C
	STATUS_NOT_COMMITTED             NTSTATUS = 0xC000002D
	STATUS_INVALID_PORT_ATTRIBUTES   NTSTATUS = 0xC000002E
	STATUS_PORT_MESSAGE_TOO_LONG     NTSTATUS = 0xC000002F
	STATUS_INVALID_PARAMETER_MIX     NTSTATUS = 0xC0000030
	STATUS_INVALID_QUOTA_LOWER       NTSTATUS = 0xC0000031
	STATUS_DISK_CORRUPT_ERROR        NTSTATUS = 0xC0000032
	STATUS_OBJECT_NAME_INVALID       NTSTATUS = 0xC0000033
	STATUS_OBJECT_NAME_NOT_FOUND     NTSTATUS = 0xC0000034
	STATUS_OBJECT_NAME_COLLISION     NTSTATUS = 0xC0000035
	STATUS_PORT_DISCONNECTED         NTSTATUS = 0xC0000037
	STATUS_DEVICE_ALREADY_ATTACHED   NTSTATUS = 0xC0000038
	STATUS_OBJECT_PATH_INVALID       NTSTATUS = 0xC0000039
	STATUS_OBJECT_PATH_NOT_FOUND     NTSTATUS = 0xC000003A
	STATUS_OBJECT_PATH_SYNTAX_BAD    NTSTATUS = 0xC000003B
	STATUS_DATA_OVERRUN              NTSTATUS = 0xC000003C
	STATUS_DATA_LATE_ERROR           NTSTATUS = 0xC000003D
	STATUS_DATA_ERROR                NTSTATUS = 0xC000003E
	STATUS_CRC_ERROR                 NTSTATUS = 0xC000003F
	STATUS_SECTION_TOO_BIG           NTSTATUS = 0xC0000040
	STATUS_PORT_CONNECTION_REFUSED   NTSTATUS = 0xC0000041
	STATUS_INVALID_PORT_HANDLE       NTSTATUS = 0xC0000042
	STATUS_SHARING_VIOLATION         NTSTATUS = 0xC0000043
	STATUS_QUOTA_EXCEEDED            NTSTATUS = 0xC0000044
	STATUS_INVALID_PAGE_PROTECTION   NTSTATUS = 0xC0000045
	STATUS_MUTANT_NOT_OWNED          NTSTATUS = 0xC0000046
	STATUS_SEMAPHORE_LIMIT_EXCEEDED  NTSTATUS = 0xC0000047
	STATUS_PORT_ALREADY_SET          NTSTATUS = 0xC0000048
	STATUS_SECTION_NOT_IMAGE         NTSTATUS = 0xC0000049
	STATUS_SUSPEND_COUNT_EXCEEDED    NTSTATUS = 0xC000004A
	STATUS_THREAD_IS_TERMINATING     NTSTATUS = 0xC000004B
	STATUS_BAD_WORKING_SET_LIMIT     NTSTATUS = 0xC000004C
	STATUS_INCOMPATIBLE_FILE_MAP     NTSTATUS = 0xC000004D
	STATUS_SECTION_PROTECTION        NTSTATUS = 0xC000004E
	STATUS_EAS_NOT_SUPPORTED         NTSTATUS = 0xC000004F
	STATUS_EA_TOO_LARGE              NTSTATUS = 0xC0000050
	STATUS_NONEXISTENT_EA_ENTRY      NTSTATUS = 0xC0000051
	STATUS_NO_EAS_ON_FILE            NTSTATUS = 0xC0000052
	STATUS_EA_CORRUPT_ERROR          NTSTATUS = 0xC0000053
	STATUS_FILE_LOCK_CONFLICT        NTSTATUS = 0xC0000054
	STATUS_LOCK_NOT_GRANTED          NTSTATUS = 0xC0000055
	STATUS_DELETE_PENDING            NTSTATUS = 0xC0000056
	STATUS_CTL_FILE_NOT_SUPPORTED    NTSTATUS = 0xC0000057
	STATUS_UNKNOWN_REVISION          NTSTATUS = 0xC0000058
	STATUS_REVISION_MISMATCH         NTSTATUS = 0xC0000059
	STATUS_INVALID_OWNER             NTSTATUS = 0xC000005A
	STATUS_INVALID_PRIMARY_GROUP     NTSTATUS = 0xC000005B
	STATUS_NO_IMPERSONATION_TOKEN    NTSTATUS = 0xC000005C
	STATUS_CANT_DISABLE_MANDATORY    NTSTATUS = 0xC000005D
	STATUS_NO_LOGON_SERVERS          NTSTATUS = 0xC000005E
	STATUS_NO_SUCH_LOGON_SESSION     NTSTATUS = 0xC000005F
	STATUS_NO_SUCH_PRIVILEGE         NTSTATUS = 0xC0000060
	STATUS_PRIVILEGE_NOT_HELD        NTSTATUS = 0xC0000061
	STATUS_INVALID_ACCOUNT_NAME      NTSTATUS = 0xC0000062
	STATUS_USER_EXISTS               NTSTATUS = 0xC0000063
	STATUS_NO_SUCH_USER              NTSTATUS = 0xC0000064
	STATUS_GROUP_EXISTS              NTSTATUS = 0xC0000065
	STATUS_NO_SUCH_GROUP             NTSTATUS = 0xC0000066
	STATUS_MEMBER_IN_GROUP           NTSTATUS = 0xC0000067
	STATUS_MEMBER_NOT_IN_GROUP       NTSTATUS = 0xC0000068
	STATUS_LAST_ADMIN                NTSTATUS = 0xC0000069
	STATUS_WRONG_PASSWORD            NTSTATUS = 0xC000006A
	STATUS_ILL_FORMED_PASSWORD       NTSTATUS = 0xC000006B
	STATUS_PASSWORD_RESTRICTION      NTSTATUS = 0xC000006C
	STATUS_LOGON_FAILURE             NTSTATUS = 0xC000006D
	STATUS_ACCOUNT_RESTRICTION       NTSTATUS = 0xC000006E
	STATUS_INVALID_LOGON_HOURS       NTSTATUS = 0xC000006F
	STATUS_INVALID_WORKSTATION       NTSTATUS = 0xC0000070
	STATUS_PASSWORD_EXPIRED          NTSTATUS = 0xC0000071
	STATUS_ACCOUNT_DISABLED          NTSTATUS = 0xC0000072
	STATUS_NONE_MAPPED               NTSTATUS = 0xC0000073
	STATUS_TOO_MANY_LUIDS_REQUESTED  NTSTATUS = 0xC0000074
	STATUS_LUIDS_EXHAUSTED           NTSTATUS = 0xC0000075
	STATUS_INVALID_SUB_AUTHORITY     NTSTATUS = 0xC0000076
	STATUS_INVALID_ACL               NTSTATUS = 0xC0000077
	STATUS_INVALID_SID               NTSTATUS = 0xC0000078
	STATUS_INVALID_SECURITY_DESCR    NTSTATUS = 0xC0000079
	STATUS_PROCEDURE_NOT_FOUND       NTSTATUS = 0xC000007A
	STATUS_INVALID_IMAGE_FORMAT      NTSTATUS = 0xC000007B
	STATUS_NO_TOKEN                  NTSTATUS = 0xC000007C
	STATUS_BAD_INHERITANCE_ACL       NTSTATUS = 0xC000007D
	STATUS_RANGE_NOT_LOCKED          NTSTATUS = 0xC000007E
	STATUS_DISK_FULL                 NTSTATUS = 0xC000007F
	STATUS_SERVER_DISABLED           NTSTATUS = 0xC0000080
	STATUS_SERVER_NOT_DISABLED       NTSTATUS = 0xC0000081
	STATUS_TOO_MANY_GUIDS_REQUESTED  NTSTATUS = 0xC0000082
	STATUS_GUIDS_EXHAUSTED           NTSTATUS = 0xC0000083
	STATUS_INVALID_ID_AUTHORITY      NTSTATUS = 0xC0000084
	STATUS_AGENTS_EXHAUSTED          NTSTATUS = 0xC0000085
	STATUS_INVALID_VOLUME_LABEL      NTSTATUS = 0xC0000086
	STATUS_SECTION_NOT_EXTENDED      NTSTATUS = 0xC0000087
	STATUS_NOT_MAPPED_DATA           NTSTATUS = 0xC0000088
	STATUS_RESOURCE_DATA_NOT_FOUND   NTSTATUS = 0xC0000089
	STATUS_RESOURCE_TYPE_NOT_FOUND   NTSTATUS = 0xC000008A
	STATUS_RESOURCE_NAME_NOT_FOUND   NTSTATUS = 0xC000008B
	STATUS_ARRAY_BOUNDS_EXCEEDED     NTSTATUS = 0xC000008C
	STATUS_FLOAT_DENORMAL_OPERAND    NTSTATUS = 0xC000008D
	STATUS_FLOAT_DIVIDE_BY_ZERO      NTSTATUS = 0xC000008E
	STATUS_FLOAT_INEXACT_RESULT      NTSTATUS = 0xC000008F
	STATUS_FLOAT_INVALID_OPERATION   NTSTATUS = 0xC0000090
	STATUS_FLOAT_OVERFLOW            NTSTATUS = 0xC0000091
	STATUS_FLOAT_STACK_CHECK         NTSTATUS = 0xC0000092
	STATUS_FLOAT_UNDERFLOW           NTSTATUS = 0xC0000093
	STATUS_INTEGER_DIVIDE_BY_ZERO    NTSTATUS = 0xC0000094
	STATUS_INTEGER_OVERFLOW          NTSTATUS = 0xC0000095
	STATUS_PRIVILEGED_INSTRUCTION    NTSTATUS = 0xC0000096
	STATUS_TOO_MANY_PAGING_FILES     NTSTATUS = 0xC0000097
	STATUS_FILE_INVALID              NTSTATUS = 0xC0000098
	STATUS_ALLOTTED_SPACE_EXCEEDED   NTSTATUS = 0xC0000099
	STATUS_INSUFFICIENT_RESOURCES    NTSTATUS = 0xC000009A
	STATUS_DFS_EXIT_PATH_FOUND       NTSTATUS = 0xC000009B
	STATUS_DEVICE_DATA_ERROR         NTSTATUS = 0xC000009C
	STATUS_DEVICE_NOT_CONNECTED      NTSTATUS = 0xC000009D
	STATUS_FREE_VM_NOT_AT_BASE       NTSTATUS = 0xC000009F
	STATUS_MEMORY_NOT_ALLOCATED      NTSTATUS = 0xC00000A0
	STATUS_WORKING_SET_QUOTA         NTSTATUS = 0xC00000A1
	STATUS_MEDIA_WRITE_PROTECTED     NTSTATUS = 0xC00000A2
	STATUS_DEVICE_NOT_READY          NTSTATUS = 0xC00000A3
	STATUS_INVALID_GROUP_ATTRIBUTES  NTSTATUS = 0xC00000A4
	STATUS_BAD_IMPERSONATION_LEVEL   NTSTATUS = 0xC00000A5
	STATUS_CANT_OPEN_ANONYMOUS       NTSTATUS = 0xC00000A6
	STATUS_BAD_VALIDATION_CLASS      NTSTATUS = 0xC00000A7
	STATUS_BAD_TOKEN_TYPE            NTSTATUS = 0xC00000A8
	STATUS_BAD_MASTER_BOOT_RECORD    NTSTATUS = 0xC00000A9
	STATUS_INSTRUCTION_MISALIGNMENT  NTSTATUS = 0xC00000AA
	STATUS_INSTANCE_NOT_AVAILABLE    NTSTATUS = 0xC00000AB
	STATUS_PIPE_NOT_AVAILABLE        NTSTATUS = 0xC00000AC
	STATUS_INVALID_PIPE_STATE        NTSTATUS = 0xC00000AD
	STATUS_PIPE_BUSY                 NTSTATUS = 0xC00000AE
	STATUS_ILLEGAL_FUNCTION          NTSTATUS = 0xC00000AF
	STATUS_PIPE_DISCONNECTED         NTSTATUS = 0xC00000B0
	STATUS_PIPE_CLOSING              NTSTATUS = 0xC00000B1
	STATUS_PIPE_CONNECTED            NTSTATUS = 0xC00000B2
	STATUS_PIPE_LISTENING            NTSTATUS = 0xC00000B3
	STATUS_INVALID_READ_MODE         NTSTATUS = 0xC00000B4
	STATUS_IO_TIMEOUT                NTSTATUS = 0xC00000B5
	STATUS_FILE_FORCED_CLOSED        NTSTATUS = 0xC00000B6
	STATUS_PROFILING_NOT_STARTED     NTSTATUS = 0xC00000B7
	STATUS_PROFILING_NOT_STOPPED     NTSTATUS = 0xC00000B8
	STATUS_COULD_NOT_INTERPRET       NTSTATUS = 0xC00000B9
	STATUS_FILE_IS_A_DIRECTORY       NTSTATUS = 0xC00000BA
	STATUS_NOT_SUPPORTED             NTSTATUS = 0xC00000BB
)
